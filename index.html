<!doctype html>
<html lang="pt-BR">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Biblioteca Online</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>body{background:#f5f7fb}.card{border-radius:12px}.topbar{background:linear-gradient(90deg,#556ee6,#9f7aea);color:white;padding:18px;border-radius:12px}</style>
</head>
<body>
<div class="container py-4">
  <div class="topbar mb-4 d-flex justify-content-between align-items-center"><h3 class="m-0">Biblioteca Online</h3><a class="btn btn-light btn-sm" href="admin.html">Painel do Operador</a></div>
  <div class="card p-3"><h5>Pesquisar livros</h5>
    <div class="row g-2 mb-2"><div class="col-md-4"><input id="q" class="form-control" placeholder="Título, autor, categoria ou Nº de Tombo"></div><div class="col-auto"><button id="searchBtn" class="btn btn-primary">Pesquisar</button></div></div>
    <div id="results"></div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="js/config.js"></script>
<script>
const results = document.getElementById('results');
document.getElementById('searchBtn').onclick = async ()=>{
  const q = document.getElementById('q').value.trim();
  results.innerHTML = 'Carregando...';
  try{
    const res = await axios.get(BACKEND_BASE + 'books.php?action=search&q=' + encodeURIComponent(q));
    const rows = res.data;
    if(!rows.length) results.innerHTML = '<div class="p-3">Nenhum resultado</div>';
    else{
      let html = '<div class="list-group">';
      for(const r of rows){
        html += `<div class="list-group-item"><div class="d-flex w-100 justify-content-between"><h5>${r.nome_livro}</h5><small>Nº Tombo: ${r.num_tombo}</small></div><p class="mb-1">Autor: ${r.autor} — Categoria: ${r.categoria} — Quant: ${r.quant}</p><small>Editora: ${r.editora} — Estante: ${r.estante} / Prateleira: ${r.prateleira}</small></div>`;
      }
      html += '</div>';
      results.innerHTML = html;
    }
  }catch(err){
    results.innerHTML = '<div class="p-3 text-danger">Erro: '+ (err.message || err) +'</div>';
  }
};
</script>
</body>
</html>
